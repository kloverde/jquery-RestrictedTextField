/*
 * RestrictedTextField v1.2
 * https://www.github.com/kloverde/jquery-RestrictedTextField
 *
 * Copyright (c) 2016, Kurtis LoVerde
 * All rights reserved.
 *
 * Donations:  https://paypal.me/KurtisLoVerde/10
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 *     1. Redistributions of source code must retain the above copyright
 *        notice, this list of conditions and the following disclaimer.
 *     2. Redistributions in binary form must reproduce the above copyright
 *        notice, this list of conditions and the following disclaimer in the
 *        documentation and/or other materials provided with the distribution.
 *     3. Neither the name of the copyright holder nor the names of its
 *        contributors may be used to endorse or promote products derived from
 *        this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

!function(a){"use strict";function b(a,b,c,e){if(void 0==b||null==b)throw"id is undefined";if(!d(b,"String"))throw"id must be a string";if(b.length<1)throw"id is empty";if(void 0==c||null==c)throw"fullRegex is undefined";if(!d(c,"RegExp"))throw"fullRegex must be a RegExp object";if(void 0!=e&&null!=e&&!d(e,"RegExp"))throw"partialRegex must be a RegExp object";a[b]={fullRegex:c,partialRegex:e}}function c(a){return void 0===a||null===a||a.length<1}function d(a,b){var c=Object.prototype.toString.call(a).slice(8,-1);return void 0!==a&&null!==a&&c.toUpperCase()===b.toUpperCase()}a.fn.RestrictedTextFieldConfig=function(){var c=a.fn.RestrictedTextFieldConfig.customTypes=a.fn.RestrictedTextFieldConfig.customTypes||[];this.addType=function(a,d,e){b(c,a,d,e)}},a.fn.restrictedTextField=function(d){function i(){var c=/^-\d*$/,d=/^-?\d*\.?\d*$/,e=/^\d*\.?\d*$/,f=/^0*\.?$|^-\d*\.?\d*$/;void 0!==a.fn.restrictedTextField.types&&null!==a.fn.restrictedTextField.types||(a.fn.restrictedTextField.types=[]);var g=a.fn.restrictedTextField.types=a.fn.restrictedTextField.types||[];b(g,"alpha",/^[a-zA-Z]+$/,null),b(g,"upperAlpha",/^[A-Z]+$/,null),b(g,"lowerAlpha",/^[a-z]+$/,null),b(g,"alphaSpace",/^[a-zA-Z\ ]+$/,null),b(g,"upperAlphaSpace",/^[A-Z\ ]+$/,null),b(g,"lowerAlphaSpace",/^[a-z\ ]+$/,null),b(g,"alphanumeric",/^[a-zA-Z\d]+$/,null),b(g,"upperAlphanumeric",/^[A-Z\d]+$/,null),b(g,"lowerAlphanumeric",/^[a-z\d]+$/,null),b(g,"alphanumericSpace",/^[a-zA-Z\d\ ]+$/,null),b(g,"upperAlphanumericSpace",/^[A-Z\d\ ]+$/,null),b(g,"lowerAlphanumericSpace",/^[a-z\d\ ]+$/,null),b(g,"int",/^-?\d+$/,c),b(g,"positiveInt",/^\d+$/,null),b(g,"negativeInt",/^0+$|^-\d+$/,c),b(g,"strictInt",/^0+$|^-?0*[1-9]\d*$/,c),b(g,"strictPositiveInt",/^\d+$/,null),b(g,"strictNegativeInt",/^0+$|^-0*[1-9]\d*$/,c),b(g,"float",/^-?\d*\.?\d+$/,d),b(g,"positiveFloat",/^\d*\.?\d+$/,e),b(g,"negativeFloat",/^-?0+$|^-?0*\.?0+$|^-\d*\.?\d+$/,f),b(g,"strictFloat",/^0*\.0+$|^-?0*\.\d*[1-9]$|^-?\d*\.\d*[1-9]\d*$|^-?0*[1-9]\d*?\d*\.\d+$/,d),b(g,"strictPositiveFloat",/^0*\.0+$|^0*\.\d*[1-9]$|^\d*\.\d*[1-9]\d*$|^\d*[1-9]*\d*\.\d+$/,e),b(g,"strictNegativeFloat",/^0*\.0+$|^-0*\.\d*[1-9]$|^-\d*\.\d*[1-9]\d*$|^-[^0]\d*?\d*\.\d+$/,f),b(g,"money",/^-?\d+\.\d{2}$/,/^-?\d*\.?\d{0,2}$/),b(g,"positiveMoney",/^\d+\.\d{2}$/,/^\d*\.?\d{0,2}$/),b(g,"negativeMoney",/^0\.00$|^-\d+\.\d{2}$/,/^0*\.?0?$|^-\d*\.?\d{0,2}$/),b(g,"accountingMoney",/^\d*\.?\d{2}$|^\(\d*\.?\d{2}\)$/,/^\(?0*\.?0{0,2}$|^[\.\d]$|^\.$|^\d*\.\d{0,2}$|^\(\d*\.?$|^\(\d*\.\d{1,2}?\)?$/),b(g,"negativeAccountingMoney",/^0\.00$|^\(\d*\.?\d{2}\)$/,/^\(?0*\.?0{0,2}$|^\(\d*\.?$|^\((\d*\.\d{1,2}?)\)?$/),b(g,"americanExpress",/^3[47]\d{13}$/,/^3[47]?$|^3[47]\d{0,13}$/),b(g,"visa",/^4(\d{12}|\d{15}|\d{18})$/,/^4\d{0,18}$/),b(g,"masterCard",/^5[12345]\d{14}$|^(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)\d{12}$/,l(/^5([12345]?|[12345]\d{0,14})$/,/^2[2-7]?$/,/^(22[2-9]|2[3-6][0-9]|27[0-2])$/,/^(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)\d{0,12}$/)),b(g,"discover",/^6011(\d{12}|\d{15})$|^65(\d{14}|\d{17})$|^64[4-9](\d{13}|\d{16})$|^(62212[6-9]|6221[3-9][0-9]|622[2-8][0-9]{2}|6229[01][0-9]|62292[0-5])(\d{10}|\d{13})$/,l(/^60?$|^601?$|^6011?$|^6011\d{0,15}$/,/^622?$/,/^622[1-9]$/,/^(6221[2-9]|622[2-8][0-9]|6229[0-2])$/,/^(62212[6-9]|6221[3-9][0-9]|622[2-8][0-9]{2}|6229[01][0-9]|62292[0-5])(\d{0,10}|\d{0,13})$/,/^64?$|^64[4-9]\d{0,16}$/,/^6(5?|5\d{0,17})$/)),b(g,"creditCard",k(!0,"americanExpress","visa","masterCard","discover"),k(!1,"americanExpress","visa","masterCard","discover")),b(g,"luhnNumber",/^\d+$/,null)}function k(){if(arguments.length<3)throw"Minimum 3 arguments: boolean, id, id";for(var b=arguments[0],c=a.fn.restrictedTextField.types,d=new RegExp(b?c[arguments[1]].fullRegex:c[arguments[1]].partialRegex),e=2;e<arguments.length;e++)d=l(d,b?c[arguments[e]].fullRegex:c[arguments[e]].partialRegex);return d}function l(){if(arguments.length<2)throw"Minimum 2 RegExp arguments";for(var a=new RegExp(arguments[0]),b=1;b<arguments.length;b++)a=new RegExp(a.source+"|"+arguments[b].source);return a}function m(a){var b=[],c=0,d=0;if(isNaN(a))throw"Value ["+a+"] is not numeric";for(var e=!0,f=a.length-2;f>=0;f--){var g=parseInt(a[f]);if(e){var h=2*g;b[f]=h>9?h-9:h}else b[f]=g;c+=b[f],e=!e}return d=9*c%10,c+=d,c%10===0&&parseInt(a[a.length-1])===d}function n(a){e.logger&&"function"==typeof e.logger&&e.logger("jquery.restrictedtextfield.js:  "+a)}var e=a.extend({type:null,preventInvalidInput:!0,logger:void 0},d),f="inputIgnored",g="validationFailed",h="validationSuccess";if("input"!==this.prop("tagName").toLowerCase())throw"RestrictedTextField can only be invoked on an input element";void 0!==a.fn.restrictedTextField.types&&null!==a.fn.restrictedTextField.types||i();var j=a.fn.restrictedTextField.types[e.type];if(c(j)&&(void 0!==a.fn.RestrictedTextFieldConfig.customTypes&&null!==a.fn.RestrictedTextFieldConfig.customTypes&&(j=a.fn.RestrictedTextFieldConfig.customTypes[e.type]),c(j)))throw"Invalid type: "+e.type;return this.each(function(){function i(a){function k(a){return a.replace(/^(-?\(?)0*(\d+\.\d+)/,"$1$2")}if(c(a))return a;var b=a;a=k(a);var d=a.length,e="-"===a[0]?"-":"",f="("===a[0]?"(":"",g=")"===a[d-1]?")":"",h=a.indexOf("."),i=a.substring(""===f&&""===e?0:1,h>0?h-1:")"===g?d-1:d),j="00";return h>-1&&(i=a.substring(""===f&&""===e?0:1,h),j=a.substring(h+1,""===g?d:d-1)),b=""!==i&&0!==parseInt(i)||0!==parseInt(j)?f+e+(""===i?"0":i)+"."+j+(1===j.length?"0":"")+g:"0.00"}var b=a(this),d="";b.on("keydown paste",function(a){d=this.value}),b.on("input",function(b){n("caught input - new value: "+this.value);var c=a(this),i=!1,k=!1,l=e.preventInvalidInput?null:g;0===this.value.length?(i=!0,k=!0,e.preventInvalidInput||(l=h)):(k=j.fullRegex.test(this.value),void 0!==j.partialRegex&&null!==j.partialRegex&&(i=j.partialRegex.test(this.value)),k?(n("passes full regex"),e.preventInvalidInput||(l=h)):(n("fails full regex"),i?(n("passes partial regex"),e.preventInvalidInput||(l=h)):(n("fails partial regex"),e.preventInvalidInput||(l=g))),i||k||e.preventInvalidInput&&(l=f,c.val(d),n('reverted field to "'+d+'"'))),null!=l&&(n("triggering "+l+" event "),c.trigger(l))}),b.on("blur",function(){var a=e.type,c=!1,d=g;if(("money"!==a&&"positiveMoney"!==a&&"negativeMoney"!==a||isNaN(this.value))&&("accountingMoney"!==a&&"negativeAccountingMoney"!==a||isNaN(this.value.replace(/^\((.*)\)$/,"$1"))))"americanExpress"===a||"visa"===a||"masterCard"===a||"discover"===a||"creditCard"===a||"luhnNumber"===a?(c=j.fullRegex.test(this.value),c&&(c=m(this.value),n(c?"passes Luhn check":"fails Luhn check"))):c=j.fullRegex.test(this.value);else{var f=i(this.value);c=j.fullRegex.test(f),c&&(this.value=f,n("blur:  formatted "+e.type+" field to "+f))}(0===this.value.length||c)&&(d=h),n("triggering "+d+" event "),b.trigger(d)})})}}(jQuery);
